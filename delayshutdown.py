import os
import wx
import sys
import wx.aui
import time

tupian = [255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 247, 184, 106, 56, 56, 42, 42, 42, 56, 70, 127, 205, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 226, 113, 49, 127, 191, 247, 255, 255, 255, 255, 255, 240, 177, 106, 49, 148, 247, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 247, 127, 56, 177, 255, 255, 255, 255, 240, 240, 212, 212, 92, 255, 247, 255, 247, 148, 49, 170, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 219, 56, 148, 255, 255, 255, 255, 255, 177, 77, 0, 0, 0, 42, 255, 155, 155, 240, 255, 240, 99, 92, 247, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 212, 49, 198, 247, 148, 226, 247, 255, 255, 198, 56, 170, 170, 170, 63, 247, 191, 177, 170, 141, 233, 255, 170, 63, 233, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 212, 56, 233, 198, 162, 155, 198, 177, 255, 255, 120, 21, 0, 0, 0, 85, 255, 255, 255, 219, 134, 177, 226, 255, 184, 49, 240, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 233, 49, 226, 255, 255, 99, 127, 233, 247, 226, 255, 255, 120, 127, 127, 106, 120, 255, 247, 247, 255, 255, 205, 162, 226, 255, 177, 77, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 77, 198, 255, 255, 255, 205, 205, 205, 42, 14, 255, 255, 134, 155, 134, 63, 127, 255, 247, 177, 177, 255, 255, 205, 148, 191, 255, 127, 141, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 177, 106, 240, 247, 255, 255, 233, 127, 7, 56, 212, 255, 255, 127, 184, 148, 56, 162, 255, 255, 255, 226, 134, 247, 255, 177, 155, 247, 247, 56, 226, 255, 255, 255, 255, 255, 255, 255, 255, 255, 49, 240, 191, 155, 162, 212, 184, 0, 113, 255, 255, 255, 255, 170, 134, 155, 70, 170, 255, 226, 170, 233, 247, 120, 247, 255, 219, 170, 240, 191, 106, 255, 255, 255, 255, 255, 255, 255, 255, 170, 127, 255, 155, 141, 212, 219, 14, 120, 255, 255, 255, 226, 170, 127, 56, 191, 99, 170, 255, 219, 198, 233, 255, 233, 127, 255, 233, 148, 191, 255, 56, 240, 255, 255, 255, 255, 255, 255, 255, 77, 219, 255, 255, 240, 255, 85, 70, 255, 255, 255, 255, 134, 113, 85, 42, 42, 21, 113, 255, 226, 134, 240, 255, 255, 162, 191, 255, 177, 148, 255, 148, 148, 255, 255, 255, 255, 255, 255, 247, 56, 255, 255, 255, 255, 212, 7, 226, 255, 255, 255, 255, 240, 85, 85, 85, 85, 42, 127, 255, 233, 184, 240, 255, 255, 255, 85, 255, 226, 155, 233, 233, 70, 255, 255, 255, 255, 255, 255, 191, 113, 255, 219, 240, 247, 120, 99, 255, 255, 255, 255, 255, 255, 113, 113, 113, 113, 85, 99, 255, 205, 113, 247, 255, 255, 255, 120, 205, 255, 184, 212, 255, 49, 255, 255, 255, 255, 255, 255, 155, 162, 219, 134, 120, 191, 56, 191, 255, 255, 255, 255, 255, 255, 141, 113, 113, 113, 106, 85, 255, 226, 177, 219, 255, 255, 255, 191, 134, 255, 191, 198, 255, 85, 219, 255, 255, 255, 255, 255, 127, 191, 233, 226, 162, 233, 7, 247, 255, 255, 255, 255, 255, 255, 127, 42, 70, 42, 63, 85, 255, 212, 127, 219, 255, 255, 255, 233, 85, 255, 233, 198, 255, 127, 191, 255, 255, 255, 255, 255, 92, 212, 255, 255, 212, 233, 35, 255, 255, 255, 255, 255, 255, 155, 49, 85, 141, 85, 113, 85, 255, 255, 247, 247, 255, 255, 255, 255, 42, 255, 212, 155, 255, 127, 170, 255, 255, 255, 255, 255, 99, 212, 255, 255, 255, 255, 42, 255, 255, 255, 255, 255, 255, 177, 56, 85, 141, 85, 113, 85, 255, 226, 170, 233, 255, 255, 255, 240, 42, 255, 198, 134, 255, 127, 170, 255, 255, 255, 255, 255, 127, 184, 255, 191, 155, 255, 56, 255, 255, 255, 255, 255, 255, 255, 134, 21, 35, 21, 49, 85, 255, 247, 205, 255, 255, 255, 255, 198, 63, 255, 226, 233, 255, 120, 198, 255, 255, 255, 255, 255, 162, 155, 233, 127, 226, 233, 63, 255, 255, 255, 255, 255, 255, 255, 141, 113, 113, 113, 106, 85, 255, 212, 120, 212, 255, 255, 255, 148, 106, 255, 191, 155, 255, 77, 226, 255, 255, 255, 255, 255, 198, 106, 255, 155, 155, 212, 134, 191, 255, 255, 255, 255, 255, 255, 99, 113, 113, 113, 85, 106, 255, 233, 170, 247, 255, 255, 255, 56, 162, 247, 191, 184, 255, 49, 255, 255, 255, 255, 255, 255, 255, 49, 255, 184, 255, 255, 233, 106, 255, 255, 255, 255, 255, 226, 85, 85, 85, 85, 42, 127, 255, 212, 120, 240, 255, 255, 191, 14, 240, 219, 170, 240, 219, 85, 255, 255, 255, 255, 255, 255, 255, 92, 205, 255, 255, 255, 255, 113, 226, 255, 255, 255, 255, 134, 113, 85, 42, 85, 42, 120, 255, 247, 205, 226, 255, 247, 49, 127, 255, 240, 155, 255, 134, 162, 255, 255, 255, 255, 255, 255, 255, 191, 99, 255, 255, 177, 212, 240, 113, 255, 255, 255, 255, 240, 205, 162, 77, 162, 85, 170, 255, 226, 170, 247, 255, 99, 28, 240, 240, 155, 247, 255, 49, 247, 255, 255, 255, 255, 255, 255, 255, 255, 70, 226, 247, 155, 134, 184, 212, 162, 255, 255, 255, 255, 255, 155, 141, 162, 77, 170, 255, 255, 226, 212, 106, 7, 198, 247, 177, 205, 247, 155, 127, 255, 255, 255, 255, 255, 255, 255, 255, 255, 198, 77, 255, 148, 177, 240, 255, 212, 155, 255, 255, 255, 255, 127, 184, 170, 85, 155, 255, 255, 212, 56, 7, 184, 255, 184, 155, 247, 240, 56, 240, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 106, 162, 205, 233, 255, 255, 240, 233, 162, 226, 255, 255, 141, 170, 134, 70, 127, 255, 226, 7, 35, 205, 247, 198, 155, 212, 255, 85, 170, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 247, 56, 205, 255, 255, 255, 155, 212, 184, 205, 255, 247, 106, 85, 85, 70, 113, 255, 255, 184, 247, 233, 184, 191, 198, 255, 141, 113, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 233, 63, 212, 255, 205, 120, 70, 255, 240, 255, 120, 21, 42, 42, 42, 85, 255, 255, 255, 184, 184, 162, 205, 255, 148, 70, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 233, 49, 177, 240, 198, 184, 255, 255, 255, 177, 42, 127, 127, 134, 56, 255, 177, 205, 148, 219, 240, 255, 120, 99, 247, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 240, 85, 99, 240, 240, 255, 255, 255, 212, 134, 35, 14, 0, 35, 255, 198, 198, 240, 255, 212, 63, 141, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 170, 42, 127, 240, 255, 255, 255, 247, 247, 255, 255, 134, 255, 255, 255, 212, 106, 70, 212, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 247, 155, 56, 77, 148, 205, 247, 255, 255, 255, 233, 191, 134, 56, 85, 191, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 226, 148, 106, 70, 42, 42, 42, 77, 113, 170, 240, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 212, 177, 170, 170, 177, 212, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 240, 148, 70, 49, 92, 127, 127, 127, 127, 92, 63, 63, 148, 233, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 226, 106, 49, 155, 233, 255, 255, 255, 255, 255, 255, 226, 255, 233, 162, 63, 106, 226, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 155, 49, 184, 255, 255, 255, 255, 255, 170, 155, 127, 120, 99, 255, 205, 247, 255, 191, 49, 141, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 247, 85, 120, 247, 233, 255, 255, 255, 247, 70, 7, 0, 0, 0, 127, 198, 148, 177, 212, 247, 247, 127, 77, 247, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 240, 77, 162, 212, 177, 177, 219, 255, 255, 240, 127, 99, 170, 170, 113, 162, 255, 219, 205, 134, 148, 212, 255, 184, 49, 233, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 247, 77, 184, 255, 170, 134, 134, 205, 198, 255, 240, 120, 28, 0, 0, 0, 177, 255, 255, 255, 240, 177, 184, 191, 255, 184, 56, 247, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 120, 148, 255, 255, 240, 155, 170, 255, 162, 191, 255, 205, 162, 184, 184, 85, 212, 255, 212, 226, 255, 255, 205, 191, 226, 255, 162, 92, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 191, 85, 255, 255, 255, 255, 170, 205, 63, 0, 134, 255, 255, 92, 162, 162, 42, 219, 255, 255, 198, 155, 255, 255, 191, 141, 219, 255, 99, 177, 255, 255, 255, 255, 255, 255, 255, 255, 255, 247, 56, 226, 212, 219, 247, 255, 205, 35, 35, 198, 255, 255, 255, 120, 134, 141, 28, 255, 255, 233, 226, 233, 134, 247, 255, 184, 184, 247, 240, 49, 247, 255, 255, 255, 255, 255, 255, 255, 255, 170, 127, 226, 141, 134, 170, 226, 42, 63, 233, 255, 255, 255, 255, 170, 127, 141, 28, 255, 255, 177, 177, 255, 240, 113, 255, 255, 177, 177, 255, 148, 148, 255, 255, 255, 255, 255, 255, 255, 255, 56, 240, 255, 191, 170, 255, 99, 42, 233, 255, 255, 255, 155, 56, 42, 77, 127, 49, 212, 255, 212, 184, 255, 255, 219, 134, 255, 205, 120, 212, 240, 56, 255, 255, 255, 255, 255, 255, 255, 219, 77, 255, 255, 255, 255, 212, 7, 205, 255, 255, 255, 255, 134, 85, 85, 14, 0, 85, 106, 255, 191, 184, 255, 255, 255, 134, 219, 255, 170, 184, 255, 92, 205, 255, 255, 255, 255, 255, 255, 148, 155, 255, 255, 255, 255, 92, 106, 255, 255, 255, 255, 255, 205, 92, 113, 120, 120, 106, 127, 255, 191, 191, 255, 255, 255, 233, 99, 255, 205, 184, 255, 170, 141, 255, 255, 255, 255, 255, 255, 92, 219, 255, 170, 219, 233, 14, 219, 255, 255, 255, 255, 255, 255, 42, 113, 141, 141, 70, 127, 255, 162, 155, 255, 255, 255, 255, 77, 247, 226, 184, 233, 226, 77, 255, 255, 255, 255, 255, 255, 56, 255, 155, 170, 106, 198, 42, 255, 255, 255, 255, 255, 255, 255, 56, 85, 106, 106, 99, 127, 255, 219, 177, 255, 255, 255, 255, 120, 198, 255, 184, 212, 255, 56, 255, 255, 255, 255, 255, 255, 70, 255, 240, 255, 134, 170, 92, 255, 255, 255, 255, 255, 255, 212, 70, 113, 113, 85, 113, 127, 255, 170, 148, 255, 255, 255, 255, 162, 155, 255, 198, 205, 255, 49, 255, 255, 255, 255, 255, 255, 42, 255, 255, 255, 233, 170, 127, 255, 255, 255, 255, 255, 255, 92, 21, 85, 85, 85, 92, 127, 255, 240, 247, 255, 255, 255, 255, 170, 127, 255, 162, 177, 255, 42, 255, 255, 255, 255, 255, 255, 70, 255, 255, 255, 247, 170, 127, 255, 255, 255, 255, 255, 255, 191, 63, 113, 113, 92, 113, 127, 255, 191, 170, 255, 255, 255, 255, 141, 127, 255, 184, 212, 255, 42, 255, 255, 255, 255, 255, 255, 49, 255, 198, 127, 191, 198, 113, 255, 255, 255, 255, 255, 255, 255, 56, 56, 70, 70, 99, 127, 255, 219, 198, 255, 255, 255, 255, 99, 162, 255, 191, 219, 255, 63, 255, 255, 255, 255, 255, 255, 85, 226, 226, 184, 184, 212, 77, 255, 255, 255, 255, 255, 255, 255, 42, 113, 141, 141, 77, 127, 255, 170, 127, 255, 255, 255, 255, 35, 205, 233, 162, 198, 233, 70, 255, 255, 255, 255, 255, 255, 141, 170, 240, 113, 233, 247, 92, 240, 255, 255, 255, 255, 255, 219, 99, 141, 155, 155, 106, 127, 255, 212, 170, 255, 255, 255, 191, 21, 255, 205, 177, 233, 184, 127, 255, 255, 255, 255, 255, 255, 205, 92, 247, 233, 255, 255, 191, 148, 255, 255, 255, 255, 255, 141, 42, 42, 7, 0, 85, 113, 255, 184, 170, 255, 255, 255, 63, 127, 255, 170, 205, 255, 106, 191, 255, 255, 255, 255, 255, 255, 255, 49, 240, 255, 255, 226, 255, 99, 247, 255, 255, 255, 255, 134, 56, 42, 63, 113, 63, 184, 255, 240, 198, 255, 255, 148, 14, 240, 240, 212, 226, 247, 49, 255, 255, 255, 255, 255, 255, 255, 255, 148, 148, 255, 255, 155, 205, 198, 127, 255, 255, 255, 255, 255, 255, 191, 127, 141, 28, 255, 255, 191, 177, 255, 184, 7, 162, 255, 198, 184, 247, 170, 127, 255, 255, 255, 255, 255, 255, 255, 255, 247, 56, 240, 219, 177, 99, 233, 212, 170, 255, 255, 255, 255, 255, 120, 134, 148, 35, 255, 255, 255, 240, 162, 7, 106, 255, 212, 170, 240, 247, 42, 240, 255, 255, 255, 255, 255, 255, 255, 255, 255, 162, 113, 226, 141, 219, 255, 255, 212, 155, 247, 255, 255, 255, 99, 170, 162, 42, 226, 255, 233, 77, 0, 113, 255, 219, 155, 177, 255, 127, 148, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 85, 177, 240, 255, 255, 240, 198, 247, 170, 212, 255, 219, 162, 198, 198, 85, 212, 255, 148, 28, 170, 255, 219, 113, 226, 255, 191, 63, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 240, 56, 212, 255, 255, 177, 170, 184, 184, 255, 247, 141, 42, 0, 0, 0, 184, 255, 255, 255, 247, 184, 184, 184, 255, 212, 56, 233, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 233, 63, 198, 255, 170, 148, 134, 255, 255, 233, 106, 77, 127, 127, 85, 170, 255, 247, 198, 170, 155, 198, 255, 212, 42, 212, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 233, 56, 155, 255, 212, 212, 255, 255, 247, 85, 28, 42, 42, 35, 127, 247, 134, 191, 226, 240, 255, 170, 49, 233, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 247, 113, 70, 212, 255, 255, 255, 255, 247, 134, 127, 85, 77, 106, 255, 212, 233, 255, 226, 77, 106, 247, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 198, 63, 85, 191, 255, 255, 255, 255, 255, 255, 255, 198, 255, 255, 191, 92, 70, 198, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 205, 106, 49, 85, 134, 170, 170, 170, 170, 134, 92, 42, 106, 205, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 219, 177, 141, 127, 127, 134, 170, 219, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255]

class Delay_Shutdown(wx.Frame):
    def __init__(self,parent,title):
        self.i=1
        self.j=1
        super(Delay_Shutdown,self).__init__(parent,title = title,size = (378,182))

        self.timer = wx.Timer(self)
        self.Bind(wx.EVT_TIMER, self.OnTimer, self.timer)

        self.timer2 = wx.Timer(self)
        self.Bind(wx.EVT_TIMER, self.OnTimer2, self.timer2)

        self.mgr = wx.aui.AuiManager(self)
        auipanel = wx.Panel(self)
        aubox = wx.BoxSizer(wx.HORIZONTAL)
        self.sttext = wx.StaticText(auipanel,-1, label="  Wxm's Delayshutdown program", style = wx.ALIGN_LEFT)
        aubox.Add(self.sttext, 1, flag=wx.ALIGN_CENTER)
        auipanel.SetSizer(aubox)

        info = wx.aui.AuiPaneInfo().Bottom()
        self.mgr.AddPane(auipanel, info)


        panel = wx.Panel(self)
        vbox = wx.BoxSizer(wx.VERTICAL)
        hbox = wx.BoxSizer(wx.HORIZONTAL)

        self.text1 = wx.TextCtrl(panel,-1,size =(56,24),style = wx.TE_CENTRE)
        hbox.Add(self.text1,1,wx.ALIGN_CENTER)

        statext1 = wx.StaticText(panel, -1,label = "  (Hours)  " ,style = wx.ALIGN_CENTER|wx.ST_NO_AUTORESIZE|wx.ST_ELLIPSIZE_MIDDLE)
        statext1.SetFont(self.GetFont())
        statext1.SetForegroundColour((255,0,0))
        hbox.Add(statext1, 1,wx.ALIGN_CENTER)

        self.text2 = wx.TextCtrl(panel, -1, size=(56, 24), style=wx.TE_CENTRE)
        hbox.Add(self.text2, 1, wx.ALIGN_CENTER)

        statext2 = wx.StaticText(panel, -1, label="  (Minute)    ",style=wx.ALIGN_CENTER|wx.ST_NO_AUTORESIZE|wx.ST_ELLIPSIZE_MIDDLE)
        statext2.SetFont(self.GetFont())
        statext2.SetForegroundColour((0, 255, 0))
        hbox.Add(statext2, 1, wx.ALIGN_CENTER)

        self.bbutton = wx.Button(panel,-1,"Shutdown",size = (64,24),style = wx.BU_AUTODRAW)
        hbox.Add(self.bbutton,1,wx.ALIGN_CENTER)
        self.bbutton.Bind(wx.EVT_BUTTON, self.OnClicked3)

        vbox.Add(hbox,1,wx.ALIGN_CENTRE_HORIZONTAL)     #第一行

        h2box = wx.BoxSizer(wx.HORIZONTAL)
        self.htext = wx.TextCtrl(panel,-1,size = (64,24),style = wx.TE_CENTRE)
        h2box.Add(self.htext,1,wx.ALIGN_CENTER_VERTICAL)

        statext3 = wx.StaticText(panel,-1,label = "   (Second)              ",style = wx.ALIGN_CENTER|wx.ST_NO_AUTORESIZE|wx.ST_ELLIPSIZE_MIDDLE)
        statext3.SetFont(self.GetFont())
        statext3.SetForegroundColour((0,0,255))
        h2box.Add(statext3,1,wx.ALIGN_CENTER)

        #self.bitm = wx.Image("xiaohui.bmp", wx.BITMAP_TYPE_BMP) #bitm = wx.Bitmap("xiaohui.bmp",wx.BITMAP_TYPE_BMP)
        #self.bitm2 = wx.Image("xiaohui.bmp", wx.BITMAP_TYPE_BMP)
        image1 = wx.Image(37, 40)
        image2 = wx.Image(37, 40)
        for x in range(37):
            for y in range(40):
                image1.SetRGB(x,y,tupian[x*40+y],tupian[x*40+y],tupian[x*40+y])
                image2.SetRGB(x, y, tupian[x * 40 + y], tupian[x * 40 + y], tupian[x * 40 + y])

        self.bitm = image1
        self.bitm2 = image2

        w = self.bitm.GetWidth()
        h = self.bitm.GetHeight()
        for x in range(w):
            for y in range(h):
                G = self.bitm.GetGreen(x,y)
                R = self.bitm.GetRed(x,y)
                B = self.bitm.GetBlue(x,y)
                if (G == 255 and R== 255 and B== 255):
                    self.bitm.SetRGB(x, y, 255, 32, 0)
                    self.bitm2.SetRGB(x,y, 0, 255, 64)
                else:
                    self.bitm.SetRGB(x, y, 0, 255, 64)
                    self.bitm2.SetRGB(x, y, 255, 32, 0)
        self.bmp1 = self.bitm.ConvertToBitmap()
        self.bmp2 = self.bitm2.ConvertToBitmap()

        self.hbutton = wx.BitmapButton(panel,bitmap = self.bmp1,size = (w+10,h+10),style = wx.BU_AUTODRAW)
        h2box.Add(self.hbutton,0,wx.ALIGN_CENTER)

        self.hbutton.Bind(wx.EVT_BUTTON, self.OnClicked)

        vbox.Add(h2box,1,wx.ALIGN_CENTRE_HORIZONTAL)    #第二行
        #panel.SetSizer(vbox)
        panel.SetSizerAndFit(vbox)

        self.mgr.Update()
        self.Bind(wx.EVT_CLOSE, self.OnClose)
        self.Centre()
        self.Show(True)

    def OnClicked(self,event):
        if (self.i):
            try:
                self.tt = int(self.htext.GetValue())
                self.i = not self.i

                event.GetEventObject().SetBitmap(self.bmp2)
                os.popen("shutdown -s -t %s" %self.tt)
                self.timer.Start(1000)
            except:
                self.sttext.SetLabel("  Program Error")

        else:
            os.popen("shutdown -a")
            self.timer.Stop()
            self.sttext.SetLabel("  Stop shutdown.")
            event.GetEventObject().SetBitmap(self.bmp1)
            self.i = not self.i


    def OnClicked3(self, event):
        if (self.j):
            try:
                t1 = int(self.text1.GetValue())
                t2 = int(self.text2.GetValue())
                shi = time.localtime(time.time()).tm_hour
                fen = time.localtime(time.time()).tm_min
                self.j = not self.j
                self.dingshi = (t1 - shi) * 3600 + (t2 - fen) * 60
                event.GetEventObject().SetLabel("")
                os.popen("shutdown -s -t %s" % self.dingshi)
                self.timer2.Start(1000)
            except:
                self.sttext.SetLabel("  Program Error")

        else:
            os.popen("shutdown -a")
            self.timer2.Stop()
            self.sttext.SetLabel("  Stop shutdown.")
            event.GetEventObject().SetLabel("ShutDown")
            self.j = not self.j

    def OnClose(self, event):
        self.mgr.UnInit()
        self.Destroy()

    def OnTimer(self, event):
        self.tt = self.tt-1
        self.sttext.SetLabel("  It's %s seconds from the shutdown." % self.tt)

    def OnTimer2(self, event):
        self.dingshi = self.dingshi- 1
        self.sttext.SetLabel("  It's %s seconds from the shutdown." % self.dingshi)


if __name__ == "__main__":
    app = wx.App()
    Delay_Shutdown(None,"Wxm's Shutdown")
    app.MainLoop()
    sys.exit()